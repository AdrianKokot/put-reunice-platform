<form [formGroup]="handler.form" (ngSubmit)="handler.submit()">
  <h3 class="tui-form__header">
    {{ 'BASIC_INFORMATION' | translate }}
  </h3>

  <div class="tui-form__row tui-form__row_multi-fields">
    <label [tuiLabel]="'TITLE' | translate" class="tui-form__multi-field">
      <tui-input
        formControlName="title"
        tuiTextfieldSize="m"
        [tuiTextfieldLabelOutside]="true"
      >
        <input tuiTextfield type="text" />
      </tui-input>

      <tui-error
        formControlName="title"
        [error]="[] | tuiFieldError | async"
      ></tui-error>
    </label>

    <label [tuiLabel]="'VISIBILITY' | translate" class="tui-form__multi-field">
      <tui-select
        formControlName="hidden"
        tuiTextfieldSize="m"
        [valueContent]="valueContent"
        [tuiTextfieldLabelOutside]="true"
      >
        <tui-data-list *tuiDataList>
          <button tuiOption [value]="false">
            {{ 'VISIBLE' | translate }}
          </button>
          <button tuiOption [value]="true">{{ 'HIDDEN' | translate }}</button>
        </tui-data-list>
      </tui-select>

      <ng-template #valueContent let-item>
        {{ (item ? 'HIDDEN' : 'VISIBLE') | translate }}
      </ng-template>

      <tui-error
        formControlName="hidden"
        [error]="[] | tuiFieldError | async"
      ></tui-error>
    </label>

    <label [tuiLabel]="'AUTHOR' | translate" class="tui-form__multi-field">
      <tui-combo-box
        tuiTextfieldSize="m"
        *tuiLet="userSearch.itemIds$ | async as items"
        formControlName="creatorId"
        [tuiTextfieldLabelOutside]="true"
        (searchChange)="userSearch.search($event)"
        [stringify]="(userSearch.stringify$ | async)!"
      >
        <tui-data-list-wrapper
          *tuiDataList
          [items]="items"
          [itemContent]="(userSearch.stringify$ | async)!"
        ></tui-data-list-wrapper>
      </tui-combo-box>

      <tui-error
        formControlName="creatorId"
        [error]="[] | tuiFieldError | async"
      ></tui-error>
    </label>
  </div>

  <label [tuiLabel]="'DESCRIPTION' | translate" class="tui-form__row">
    <tui-text-area
      formControlName="description"
      tuiTextfieldSize="m"
      [tuiTextfieldLabelOutside]="true"
      [maxLength]="255"
      [expandable]="true"
    >
    </tui-text-area>

    <tui-error
      formControlName="description"
      [error]="[] | tuiFieldError | async"
    ></tui-error>
  </label>

  <h3 class="tui-form__header">
    {{ 'PAGE_LOCATION' | translate }}
  </h3>

  <label [tuiLabel]="'UNIVERSITY' | translate" class="tui-form__row">
    <tui-combo-box
      tuiTextfieldSize="m"
      *tuiLet="universitySearch.itemIds$ | async as items"
      formControlName="universityId"
      [tuiTextfieldLabelOutside]="true"
      (searchChange)="universitySearch.search($event)"
      [stringify]="(universitySearch.stringify$ | async)!"
    >
      <tui-data-list-wrapper
        *tuiDataList
        [items]="items"
        [itemContent]="(universitySearch.stringify$ | async)!"
      ></tui-data-list-wrapper>
    </tui-combo-box>

    <tui-error
      formControlName="universityId"
      [error]="[] | tuiFieldError | async"
    ></tui-error>
  </label>

  <div class="tui-form__row" *ngIf="pagesTree$ | async as items">
    <p class="t-label tui-space_top-0 tui-space_bottom-2">
      {{ 'PARENT_PAGE' | translate }}
    </p>

    <tui-tree
      [tuiTreeController]="false"
      [map]="pageTreeMap"
      [value]="items"
      [content]="treeContent"
      [childrenHandler]="pagesTreeHandler"
    ></tui-tree>
    <ng-template #treeContent let-page>
      <label
        [class._selected]="inputElement.checked"
        class="cursor-pointer reunice-tree-item-option"
      >
        <input
          type="radio"
          formControlName="parentId"
          [value]="page.id"
          #inputElement
        />

        <span>
          {{ page.title }}
        </span>
      </label>
    </ng-template>
  </div>

  <h3 class="tui-form__header">
    {{ 'PAGE_CONTENT' | translate }}
  </h3>

  <label class="tui-form__row" [tuiLabel]="'CONTENT' | translate">
    <tui-editor formControlName="content"></tui-editor>

    <tui-error
      formControlName="content"
      [error]="[] | tuiFieldError | async"
    ></tui-error>
  </label>

  <div class="tui-form__buttons tui-form__buttons_align_end">
    <a
      [routerLink]="['..']"
      tuiButton
      type="button"
      appearance="flat"
      size="m"
      class="tui-form__button"
    >
      {{ 'CANCEL' | translate }}
    </a>
    <button
      tuiButton
      size="m"
      type="submit"
      class="tui-form__button"
      [showLoader]="(handler.loading$ | async) ?? false"
    >
      {{ 'SAVE' | translate }}
    </button>
  </div>
</form>
